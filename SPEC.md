# ポモドローグ (Pomo-Drogue) - (SPEC.md)

## 1. プロジェクト概要

* **コンセプト:** ポモドーロ・テクニック（25分集中・5分休憩）とターン制ローグライクの融合。
* **プラットフォーム:** iOS (React Native または Capacitor 推奨)。
* **アートスタイル:** 16x16ピクセルアート（ドット絵）。

## 2. コア・ゲームサイクル

### 2.1 集中フェーズ (Focus Phase: 25分)

* **画面演出:** 焚き火の前で座禅を組む冒険者。
* **離脱検知 (iOS AppState):** * アプリがバックグラウンド/非アクティブになったら**3秒間の猶予期間**を開始。
* 3秒以内に復帰しない場合、装備中の武器の**耐久度(Durability)を-1**する。


* **成功報酬:** 完遂（25分）で武器の耐久度を**+1回復**（最大値まで）し、探索フェーズへ移行。

### 2.2 探索フェーズ (Discovery Phase: 5分)

* **画面演出:** 見下ろし型グリッドマップ。
* **ターン制ロジック:** プレイヤーが1マス移動/攻撃すると、敵も1マス行動。
* **勝利条件:** 制限時間内に「階段」へ到達し、次階層（B1F→B2F...）へ進む。
* **敗北条件:** HPが0になる（全ロスト）。時間切れは現在階層に留まる。

## 3. 装備・アイテムシステム

### 3.1 武器バリエーション

武器ごとに「攻撃力」と「最大耐久度」が異なり、強力な武器ほど壊れやすい。

* **錆びた刀:** ATK 5 / DUR 5 (頑丈)
* **無銘の刀:** ATK 10 / DUR 3 (標準)
* **妖刀:** ATK 40 / DUR 1 (強力だが、一度の集中失敗で即破壊)

### 3.2 アイテム

* **砥石 (Whetstone):** 探索マップで拾得可能。使用すると装備中の武器耐久度を最大まで回復。
* **持ち物枠:** 最大3枠。

## 4. 敵キャラクター

* **骸骨剣士:** プレイヤーを追尾。過去に集中に失敗した者の成れの果て。

## 5. iOS実装要件

* **AppState監視:** `background` 移行時のタイムスタンプ計測と `setTimeout` (3s) による判定。
* **通知:** 3秒猶予中の「警告通知」および、フェーズ終了時の「完了通知」。
* **永続化:** 階層、装備、耐久度、累計集中時間を `AsyncStorage` 等で保存。
